%局部坐标系下两节点12自由度梁单元的单元刚度矩阵,忽略大变形\
%N是梁的轴力
function [k,m]=beamElementStiffnessMatrix(N,L)
%% 梁的材料参数
E=350000;%弹性模量
mu=0.3;%泊松比
rho=1.5e-9;%密度
r=5;%圆截面半径为5

G=E/(2*(1+mu));%计算剪切模量
D=2*r;%计算截面直径
A=pi*r^2;%计算截面面积
Iy=pi*D^4/64;%计算圆截面惯性矩
Iz=pi*D^4/64;%计算圆截面惯性矩
Ip=pi*D^4/32;%计算圆截面极惯性矩
%% 刚度阵
k1=[E*A/L,0,          0;
    0,    12*E*Iz/L^3,0;
    0,    0,          12*E*Iy/L^3;];
k2=[0,0,         0;
    0,0,         6*E*Iz/L^2;
    0,-6*E*Iy/L^2,0;];
k3=[G*Ip/L,0,       0;
    0,     4*E*Iy/L,0;
    0,     0,       4*E*Iz/L;];
k4=[-G*Ip/L,0,       0;
    0,      2*E*Iy/L,0;
    0,      0,       2*E*Iz/L;];
kl=[k1,  k2, -k1, k2;
    k2', k3, -k2',k4;
   -k1',-k2,  k1,-k2;
    k2', k4',-k2',k3;];
g1=[0,0,0;
    0,6/(5*L),0;
    0,0,6/(5*L);];
g2=[0,0,0;
    0,0,L/10;
    0,-L/10,0;];
g3=[0,2*L/15,0;
    0,0,2*L/15;
    0,0,0;];
g4=[0,0,0;
    0,-L/30,0;
    0,0,-L/30;];
kSigma=N.*[g1,   g2, -g1,  g2;
           g2',  g3,  g2,  g4;
          -g1',  g2', g1, -g2;
           g2',  g4',-g2', g3;];
k=kl+kSigma;
%% 一致质量阵
m11=[140,0,    0,    0,        0,    0;
     0,  156,  0,    0,        0,    22*L;
     0,  0,    156,  0,       -22*L, 0;
     0,  0,    0,    140*Ip/A, 0,    0;
     0,  0,   -22*L, 0,        4*L^2,0; 
     0,  22*L,  0,   0,        0,    4*L^2];
m12=[70,0,   0,    0,      0,     0;
     0, 54,  0,    0,      0,    -13*L;
     0, 0,   54,   0,      13*L,  0;
     0, 0,   0,    70*Ip/A,0,     0;
     0, 0,   13*L, 0,      -3*L^2,0;
     0,-13*L,0,    0,      0,     -3*L^2;];
m21=m12';
m22=[140,0,    0,     0,       0,     0;
     0,  156,  0,     0,       0,    -22*L;
     0,  0,    156,   0,       22*L,  0;
     0,  0,    0,     140*Ip/A,0,     0;
     0,  0,    22*L,  0,       4*L^2, 0;
     0, -22*L, 0,     0,       0,     4*L^2;];
m=rho*A/L/420.*[m11,m12;
                m21,m22];
end