%两节点十二自由度圆形梁单元，
%输入 内压力N
%输入 单元长度L
%输出12×12刚度阵、质量阵
function [k,m]=beamElementStiffnessMatrix(N,L)
%% 参数
E=350000;%弹性模量mpa
mu=0.3;%泊松比
rho=1.5e-9;%密度
r=5;%圆截面半径为5mm
G=E/(2*(1+mu));%计算剪切模量
D=2*r;%计算截面直径
A=pi*r^2;%计算截面面积
Iy=pi*D^4/64;%计算圆截面惯性矩
Iz=pi*D^4/64;%计算圆截面惯性矩
Ip=pi*D^4/32;%计算圆截面极惯性矩
%% 刚度阵
kl=[A*E/L,  0,            0,           0,            0,             0,          -A*E/L, 0,            0,            0,      0,           0;
    0,      12*E*Iz/L^3,  0,           0,            0,             6*E*Iz/L^2, 0,      -12*E*Iz/L^3, 0,            0,      0,           6*E*Iz/L^2;
    0,      0,            12*E*Iy/L^3, 0,            -6*E*Iy/L^2,   0,          0,      0,            -12*E*Iy/L^3, 0,      -6*E*Iy/L^2, 0;
    0,      0,            0,           G*Ip/L,       0,             0,          0,      0,            0,            -G*Ip/L,0,           0;
    0,      0,            -6*E*Iy/L^2, 0,            4*E*Iy/L,      0,          0,      0,            6*E*Iy/L^2,   0,      2*E*Iy/L,    0;
    0,      6*E*Iz/L^2,   0,           0,            0,             4*E*Iz/L,   0,      -6*E*Iz/L^2,  0,            0,      0,           2*E*Iz/L;
    -A*E/L, 0,            0,           0,            0,             0,          A*E/L,  0,            0,            0,      0,           0;
    0,      -12*E*Iz/L^3, 0,           0,            0,            -6*E*Iz/L^2, 0,      12*E*Iz/L^3,  0,            0,      0,           -6*E*Iz/L^2;
    0,      0,            -12*E*Iy/L^3,0,            6*E*Iy/L^2,    0,          0,      0,            12*E*Iy/L^3,  0,      6*E*Iy/L^2,  0;
    0,      0,            0,           -G*Ip/L,      0,             0,          0,      0,            0,            G*Ip/L, 0,           0;
    0,      0,           -6*E*Iy/L^2,  0,            2*E*Iy/L,      0,          0,      0,            6*E*Iy/L^2,   0,      4*E*Iy/L,    0;
    0,      6*E*Iz/L^2,   0,           0,            0,             2*E*Iz/L,   0,      -6*E*Iz/L^2,  0,            0,      0,           4*E*Iz/L;];
g1=[0,0,      0;
    0,6/(5*L),0;
    0,0,      6/(5*L);];
g2=[0, 0,   0;
    0, 0,   L/10;
    0,-L/10,0;];
g3=[0,2*L/15,0;
    0,0,     2*L/15;
    0,0,     0;];
g4=[0,0,     0;
    0,-L/30, 0;
    0,0,    -L/30;];
kSigma=N.*[g1,   g2, -g1,  g2;
           g2',  g3,  g2,  g4;
          -g1',  g2', g1, -g2;
           g2',  g4',-g2', g3;];
k=kl+kSigma;
%% 一致质量阵
m=zeros(12);
m1=1/3;
m2=13/35+(6*Iz)/(5*A*L^2);
m3=13/35+(6*Iy)/(5*A*L^2);
m4=Ip/(3*A);
m5=L^2/105+(2*Iy)/(15*A);
m6=L^2/105+(2*Iy)/(15*A);
m7=11*L/210+Iz/(10*A*L);
m8=-(11*L/210+Iy/10*A*L);
m9=9/70-(6*Iz)/(5*A*L^2);
m10=9/70-(6*Iy)/(5*A*L^2);
m11=-13*L/420+Iz/(10*A*L);
m12=13*L/420-Iy/(10*A*L);
m13=-L^2/140-Iy/(30*A);
m14=-L^2/140-Iz/(30*A);

m(1,1)=m1;m(2,2)=m2;m(3,3)=m3;m(4,4)=m4;m(5,5)=m5;m(6,6)=m6;m(7,7)=m1;m(8,8)=m2;m(9,9)=m3;m(10,10)=m4;m(11,11)=m5;m(12,12)=m6;
m(1,7)=m1/2;m(7,1)=m(1,7);
m(2,6)=m7;m(6,2)=m(2,6);
m(2,8)=m9;m(8,2)=m(2,8);
m(2,12)=m11;m(12,2)=m(2,12);
m(3,5)=m8;m(5,3)=m(3,5);
m(3,9)=m10;m(9,3)=m(3,9);
m(3,11)=m12;m(11,3)=m(3,11);
m(4,10)=m4/2;m(10,4)=m(4,10);
m(5,9)=-m12;m(9,5)=m(5,9);
m(5,11)=m13;m(11,5)=m(5,11);
m(6,8)=-m11;m(8,6)=m(6,8);
m(6,12)=m14;m(12,6)=m(6,12);
m(8,12)=-m7;m(12,8)=m(8,12);
m(9,11)=-m8;m(11,9)=m(9,11);
m=rho*A*L.*m;
end